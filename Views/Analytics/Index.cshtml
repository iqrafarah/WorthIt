@using WorthIt.Migrations
@{
    ViewData["Title"] = "Summary";
}

@model List<WorthIt.Models.ExpenseItemViewModel>


<div class="py-4 analytics-summary">
    <div class="expenses-summary">
        <h1 class="display-4 price-title price my-3">
            $100
        </h1>
        <span class="text-foreground-color"> Total Spent this month</span>
    </div>

    @await Html.PartialAsync("_Graph")


    <div class="expenses-summary mt-5">

        <div>
            <div class="analytics-item rounded-3 d-flex justify-content-between align-items-center my-3">
                <div class="d-flex align-items-center gap-3">
                    <div
                        class="expense-icon bg-primary d-flex flex-column align-items-center gap-y-2 text-black rounded-circle">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" width="20"
                            height="20" class="size-5">
                            <path fill-rule="evenodd"
                                d="M12.577 4.878a.75.75 0 0 1 .919-.53l4.78 1.281a.75.75 0 0 1 .531.919l-1.281 4.78a.75.75 0 0 1-1.449-.387l.81-3.022a19.407 19.407 0 0 0-5.594 5.203.75.75 0 0 1-1.139.093L7 10.06l-4.72 4.72a.75.75 0 0 1-1.06-1.061l5.25-5.25a.75.75 0 0 1 1.06 0l3.074 3.073a20.923 20.923 0 0 1 5.545-4.931l-3.042-.815a.75.75 0 0 1-.53-.919Z"
                                clip-rule="evenodd" />
                        </svg>

                    </div>
                    <div class="d-flex flex-column">
                        <span class="expense-name text-black text-500 text-start">
                            Highest Spent
                        </span>
                        <span class="expense-date text-start small">
                            Thu Mar 07 2025
                        </span>
                    </div>
                </div>
                <span class="price-amount">580$</span>
            </div>

            <div class="analytics-item rounded-3 d-flex justify-content-between align-items-center my-3">
                <div class="d-flex align-items-center gap-3">
                    <div
                        class="expense-icon bg-primary d-flex flex-column align-items-center gap-y-2 text-black rounded-circle">
                        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5"
                            stroke="#000" width="20" height="20" class="size-6">
                            <path stroke-linecap="round" stroke-linejoin="round"
                                d="M9.568 3H5.25A2.25 2.25 0 0 0 3 5.25v4.318c0 .597.237 1.17.659 1.591l9.581 9.581c.699.699 1.78.872 2.607.33a18.095 18.095 0 0 0 5.223-5.223c.542-.827.369-1.908-.33-2.607L11.16 3.66A2.25 2.25 0 0 0 9.568 3Z" />
                            <path stroke-linecap="round" stroke-linejoin="round" d="M6 6h.008v.008H6V6Z" />
                        </svg>

                    </div>
                    <div class="d-flex flex-column">
                        <span class="expense-name text-black text-500 text-start">
                            Most Entry
                        </span>
                        <span class="expense-date text-start small">
                            Thu Mar 07 2025
                        </span>
                    </div>
                </div>
                <span class="price-amount">580$</span>
            </div>


            @{
                var groupedByCategory = Model
                .GroupBy(e => new { e.Category.CategoryName, e.Category.CategoryIcon })
                .ToList();

            }
            <section class="expenses-list">


                @foreach (var group in groupedByCategory)
                {
                    var CategoryName = group.Key.CategoryName ?? "Unknown";
                    var categoryIcon = group.Key.CategoryIcon ?? "";
                    var entryCount = group.Count();


                    var totalHours = 2;

                    <div class="expense-item">
                        <div class="expense-item d-flex justify-content-between align-items-center my-3">
                            <div class="d-flex align-items-center gap-3">
                                <div
                                    class="expense-icon bg-primary d-flex flex-column align-items-center gap-y-2 text-black rounded-circle">
                                    @categoryIcon
                                </div>
                                <div class="d-flex flex-column">
                                    <span class="expense-name text-black text-500 text-start">
                                        @CategoryName
                                    </span>
                                    <span class="expense-date text-start">
                                        @if (entryCount == 1)
                                        {
                                            @($"{entryCount} entry")
                                        }
                                        else
                                        {
                                            @($"{entryCount} entries")
                                        }
                                    </span>
                                </div>
                            </div>
                            <div class="hour-cost">
                                @totalHours hours
                            </div>
                        </div>
                    </div>
                }
            </section>
        </div>
    </div>
</div>